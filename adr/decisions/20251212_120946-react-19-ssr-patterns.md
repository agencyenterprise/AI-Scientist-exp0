# 20251212_120946-react-19-ssr-patterns

## Status

Accepted

## Context

With the upgrade to React 19, several existing patterns for SSR (Server-Side Rendering) guards and state management were no longer aligned with React's recommended approaches. The codebase had accumulated patterns that could cause hydration mismatches and cascading renders.

**Source commits:**

- cec2d0e: Refactor: Consolidate React SSR guards, modal state resets, and conditional state updates to align with React 19 guidelines.

## Decision

Adopted React 19-compliant patterns for SSR and state management:

1. **SSR Guards**: Replaced `useState` + `useEffect` SSR guards with dedicated `useIsClient` hook
2. **Modal State Resets**: Removed state synchronization effects in modals; rely on `key` prop approach for state resets instead
3. **Conditional State Updates**: Consolidated into derived computations or reset functions to prevent cascading renders
4. **Auto-scroll Logic**: Removed redundant implementations when handled upstream

## Consequences

### Positive

- Eliminates hydration mismatches
- Reduces cascading render cycles
- Cleaner, more predictable component behavior
- Aligned with React 19 best practices

### Negative

- Breaking change for existing component patterns
- Requires understanding of `key` prop for state resets

### Constraints

- **Never** use `useState` + `useEffect` for SSR guards; use `useIsClient` hook instead
- **Never** use effects to synchronize modal state; use `key` prop for resets
- **Always** prefer derived state over synchronized state
- **Always** check if logic is handled upstream before adding component-level handlers
